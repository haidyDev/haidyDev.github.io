<!doctype html>
<html lang="fi">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Demos | Heidi Maunu</title>

  <link rel="stylesheet" href="/assets/css/style.css">
</head>

<body>

  <!-- ======================
       Header / Navigation
  ======================= -->
  <header class="nav">
    <div class="container nav-inner">
      <div class="brand">
        <span class="name">Heidi Maunu</span>
        <span class="role">Power Platform / low-code student portfolio</span>
      </div>

      <nav class="nav-links">
        <a href="/index.html">Home</a>
        <a href="/projects.html">Projects</a>
        <a href="/about.html">About</a>
      </nav>
    </div>
  </header>

  <main class="hero">
    <div class="container">
      <section class="card" style="padding: 22px;">
        <h1>Demos</h1>
        <div style="margin-top: 12px;">
          <label for="demoSearchInput"><strong>Search demos:</strong></label>
          <input id="demoSearchInput" type="search" placeholder="Search by title, tag, stack, focus..." style="margin-top: 8px; width: 100%; max-width: 460px; padding: 10px 12px; border: 1px solid var(--line); border-radius: 12px; background: rgba(255, 255, 255, 0.06); color: var(--text);">
        </div>
        <div id="filters" style="margin-top: 12px;">
          <p style="margin: 0 0 8px 0;">
            <strong>Filter:</strong>
            <button class="btn" id="showAllBtn" type="button" style="margin-left: 8px;">Show all</button>
          </p>
          <p id="category-filters" style="margin: 0 0 8px 0;"></p>
          <p id="tag-filters" style="margin: 0;"></p>
        </div>
        <div id="demos-status" class="card" style="margin-top: 12px; padding: 14px; display: none;"></div>
        <div id="demos-root"></div>
      </section>
    </div>
  </main>

  <!-- ======================
       Footer
  ======================= -->
  <footer>
    <div class="container footer-inner">
      <span>© 2026 Heidi Maunu</span>

      <span class="footer-note">
        Power Platform · Low-code · Portfolio
      </span>

      <span class="footer-contact">
        📧
        <a href="mailto:heidi.maunu@gmail.com">
          heidi.maunu@gmail.com
        </a>
        &nbsp;·&nbsp;
        🔗
        <a href="https://www.linkedin.com/in/heidimaunu/" target="_blank" rel="noopener">
          LinkedIn
        </a>
      </span>
    </div>
  </footer>

  <script>
    (function () {
      var root = document.getElementById('demos-root');
      var statusBox = document.getElementById('demos-status');
      var searchInput = document.getElementById('demoSearchInput');
      var categoryFiltersRoot = document.getElementById('category-filters');
      var tagFiltersRoot = document.getElementById('tag-filters');
      var showAllBtn = document.getElementById('showAllBtn');
      var categoryOrder = ['Low-code', 'Automation', 'Data', 'UX/UI', 'Architecture'];
      var state = {
        demos: [],
        category: null,
        tag: null,
        query: '',
        openPreviewPath: null
      };

      function renderDemoCard(demo) {
        var card = document.createElement('article');
        card.className = 'card';
        card.style.padding = '16px';
        card.style.marginTop = '12px';
        card.style.cursor = 'pointer';

        var title = document.createElement('h3');
        title.textContent = demo.title;

        var description = document.createElement('p');
        description.textContent = demo.description || '';

        var summaryRow = document.createElement('p');
        summaryRow.style.margin = '8px 0 0 0';

        if (demo.focus) {
          var focusLabel = document.createElement('span');
          focusLabel.textContent = 'Focus: ' + demo.focus;
          focusLabel.style.display = 'inline-block';
          focusLabel.style.fontSize = '0.78rem';
          focusLabel.style.padding = '4px 8px';
          focusLabel.style.marginRight = '6px';
          focusLabel.style.marginBottom = '6px';
          focusLabel.style.borderRadius = '999px';
          focusLabel.style.border = '1px solid var(--line)';
          focusLabel.style.background = 'rgba(242, 210, 122, 0.18)';
          summaryRow.appendChild(focusLabel);
        }

        if (demo.level) {
          var levelLabel = document.createElement('span');
          levelLabel.textContent = 'Level: ' + demo.level;
          levelLabel.style.display = 'inline-block';
          levelLabel.style.fontSize = '0.78rem';
          levelLabel.style.padding = '4px 8px';
          levelLabel.style.marginRight = '6px';
          levelLabel.style.marginBottom = '6px';
          levelLabel.style.borderRadius = '999px';
          levelLabel.style.border = '1px solid var(--line)';
          levelLabel.style.background = 'rgba(255, 255, 255, 0.06)';
          summaryRow.appendChild(levelLabel);
        }

        var stackLine = document.createElement('p');
        stackLine.style.margin = '6px 0 0 0';
        stackLine.style.fontSize = '0.82rem';
        stackLine.style.color = 'var(--muted)';
        if ((demo.stack || []).length > 0) {
          stackLine.textContent = 'Stack: ' + demo.stack.join(' • ');
        }

        var tagsRow = document.createElement('p');
        tagsRow.style.marginTop = '8px';

        (demo.tags || []).forEach(function (tag) {
          var badge = document.createElement('span');
          badge.textContent = tag;
          badge.style.display = 'inline-block';
          badge.style.fontSize = '0.78rem';
          badge.style.padding = '4px 8px';
          badge.style.marginRight = '6px';
          badge.style.marginBottom = '6px';
          badge.style.borderRadius = '999px';
          badge.style.border = '1px solid var(--line)';
          badge.style.background = 'rgba(255, 255, 255, 0.06)';
          tagsRow.appendChild(badge);
        });

        var actions = document.createElement('p');
        actions.style.display = 'flex';
        actions.style.gap = '8px';
        actions.style.flexWrap = 'wrap';

        var link = document.createElement('a');
        link.className = 'btn';
        link.href = demo.path;
        link.textContent = 'Open demo';
        actions.appendChild(link);

        var previewBtn = document.createElement('button');
        previewBtn.className = 'btn';
        previewBtn.type = 'button';
        previewBtn.textContent = state.openPreviewPath === demo.path ? 'Hide preview' : 'Preview';
        previewBtn.addEventListener('click', function (event) {
          event.stopPropagation();
          togglePreview(demo.path);
        });
        actions.appendChild(previewBtn);

        var previewWrap = document.createElement('div');
        previewWrap.style.marginTop = '10px';
        previewWrap.style.border = '1px solid var(--line)';
        previewWrap.style.borderRadius = '12px';
        previewWrap.style.overflow = 'hidden';
        previewWrap.style.display = state.openPreviewPath === demo.path ? 'block' : 'none';

        if (state.openPreviewPath === demo.path) {
          var iframe = document.createElement('iframe');
          iframe.src = demo.path;
          iframe.title = demo.title + ' preview';
          iframe.loading = 'lazy';
          iframe.style.width = '100%';
          iframe.style.height = '360px';
          iframe.style.border = '0';
          previewWrap.appendChild(iframe);
        }

        card.addEventListener('click', function (event) {
          if (event.target.closest('a, button, iframe')) {
            return;
          }
          togglePreview(demo.path);
        });

        card.appendChild(title);
        card.appendChild(description);
        if (summaryRow.childNodes.length > 0) {
          card.appendChild(summaryRow);
        }
        if (stackLine.textContent) {
          card.appendChild(stackLine);
        }
        card.appendChild(tagsRow);
        card.appendChild(actions);
        card.appendChild(previewWrap);

        return card;
      }

      function togglePreview(path) {
        state.openPreviewPath = state.openPreviewPath === path ? null : path;
        renderDemos();
      }

      function createFilterButton(label, onClick) {
        var btn = document.createElement('button');
        btn.className = 'btn';
        btn.type = 'button';
        btn.textContent = label;
        btn.style.marginRight = '8px';
        btn.style.marginBottom = '8px';
        btn.addEventListener('click', onClick);
        return btn;
      }

      function getQueryParams() {
        var params = new URLSearchParams(window.location.search);
        return {
          category: params.get('category'),
          tag: params.get('tag'),
          q: params.get('q')
        };
      }

      function updateURLFromFilter() {
        var params = new URLSearchParams();

        if (state.category) {
          params.set('category', state.category);
        }

        if (state.tag) {
          params.set('tag', state.tag);
        }

        if (state.query) {
          params.set('q', state.query);
        }

        var query = params.toString();
        var url = window.location.pathname + (query ? '?' + query : '');
        window.history.pushState({}, '', url);
      }

      function applyFilterFromURL() {
        var params = getQueryParams();

        var hasCategory = state.demos.some(function (demo) {
          return demo.category === params.category;
        });
        var hasTag = state.demos.some(function (demo) {
          return (demo.tags || []).indexOf(params.tag) !== -1;
        });

        state.category = hasCategory ? params.category : null;
        state.tag = hasTag ? params.tag : null;
        state.query = (params.q || '').trim();

        if (searchInput) {
          searchInput.value = state.query;
        }
      }

      function getFilteredDemos() {
        var normalizedQuery = state.query.toLowerCase();

        return state.demos.filter(function (demo) {
          var categoryMatch = !state.category || demo.category === state.category;
          var tagMatch = !state.tag || (demo.tags || []).indexOf(state.tag) !== -1;

          var searchText = [
            demo.title || '',
            demo.description || '',
            (demo.tags || []).join(' '),
            (demo.stack || []).join(' '),
            demo.focus || '',
            demo.category || ''
          ].join(' ').toLowerCase();
          var searchMatch = !normalizedQuery || searchText.indexOf(normalizedQuery) !== -1;

          return categoryMatch && tagMatch && searchMatch;
        });
      }

      function renderCategorySection(category, demos) {
        var section = document.createElement('section');
        section.style.marginTop = '20px';

        var heading = document.createElement('h2');
        heading.textContent = category;
        section.appendChild(heading);

        demos.forEach(function (demo) {
          section.appendChild(renderDemoCard(demo));
        });

        return section;
      }

      function updateFilterButtonStates() {
        var allButtons = document.querySelectorAll('#filters .btn');
        allButtons.forEach(function (button) {
          button.style.opacity = '0.85';
        });

        if (showAllBtn) {
          showAllBtn.style.opacity = state.category || state.tag ? '0.85' : '1';
        }

        var activeCategoryBtn = document.querySelector('[data-filter-type="category"][data-filter-value="' + state.category + '"]');
        if (activeCategoryBtn) {
          activeCategoryBtn.style.opacity = '1';
        }

        var activeTagBtn = document.querySelector('[data-filter-type="tag"][data-filter-value="' + state.tag + '"]');
        if (activeTagBtn) {
          activeTagBtn.style.opacity = '1';
        }
      }

      function resetAllFilters() {
        state.category = null;
        state.tag = null;
        state.query = '';

        if (searchInput) {
          searchInput.value = '';
        }

        updateURLFromFilter();
      }

      function showLoadingState() {
        root.innerHTML = '';
        statusBox.style.display = 'block';
        statusBox.innerHTML = '<p style="margin: 0;">Loading demos...</p>';
      }

      function showEmptyState() {
        root.innerHTML = '';
        statusBox.style.display = 'block';
        statusBox.innerHTML = '';

        var message = document.createElement('p');
        message.style.margin = '0';
        message.textContent = 'No demos match current filters.';
        statusBox.appendChild(message);

        var actions = document.createElement('p');
        actions.style.margin = '10px 0 0 0';

        var resetBtn = document.createElement('button');
        resetBtn.className = 'btn';
        resetBtn.type = 'button';
        resetBtn.textContent = 'Reset filters';
        resetBtn.addEventListener('click', function () {
          resetAllFilters();
          renderDemos();
        });
        actions.appendChild(resetBtn);

        statusBox.appendChild(actions);
      }

      function hideStatusState() {
        statusBox.style.display = 'none';
        statusBox.innerHTML = '';
      }

      function renderDemos() {
        root.innerHTML = '';

        var filtered = getFilteredDemos();
        if (!filtered.length) {
          showEmptyState();
          updateFilterButtonStates();
          return;
        }

        hideStatusState();

        var grouped = filtered.reduce(function (acc, demo) {
          var key = demo.category || 'Other';
          if (!acc[key]) {
            acc[key] = [];
          }
          acc[key].push(demo);
          return acc;
        }, {});

        categoryOrder.forEach(function (category) {
          if (grouped[category] && grouped[category].length > 0) {
            root.appendChild(renderCategorySection(category, grouped[category]));
          }
        });

        Object.keys(grouped).forEach(function (category) {
          if (categoryOrder.indexOf(category) === -1) {
            root.appendChild(renderCategorySection(category, grouped[category]));
          }
        });

        updateFilterButtonStates();
      }

      function renderFilters() {
        categoryFiltersRoot.innerHTML = '';
        tagFiltersRoot.innerHTML = '';

        var categories = state.demos
          .map(function (demo) { return demo.category; })
          .filter(function (value, index, arr) { return value && arr.indexOf(value) === index; });

        var sortedCategories = categoryOrder
          .filter(function (category) { return categories.indexOf(category) !== -1; })
          .concat(categories.filter(function (category) { return categoryOrder.indexOf(category) === -1; }));

        if (sortedCategories.length > 0) {
          var categoryLabel = document.createElement('strong');
          categoryLabel.textContent = 'Categories: ';
          categoryFiltersRoot.appendChild(categoryLabel);
        }

        sortedCategories.forEach(function (category) {
          var btn = createFilterButton(category, function () {
            state.category = category;
            updateURLFromFilter();
            renderDemos();
          });
          btn.setAttribute('data-filter-type', 'category');
          btn.setAttribute('data-filter-value', category);
          categoryFiltersRoot.appendChild(btn);
        });

        var tags = state.demos.reduce(function (acc, demo) {
          (demo.tags || []).forEach(function (tag) {
            if (acc.indexOf(tag) === -1) {
              acc.push(tag);
            }
          });
          return acc;
        }, []).sort();

        if (tags.length > 0) {
          var tagLabel = document.createElement('strong');
          tagLabel.textContent = 'Tags: ';
          tagFiltersRoot.appendChild(tagLabel);
        }

        tags.forEach(function (tag) {
          var btn = createFilterButton(tag, function () {
            state.tag = tag;
            updateURLFromFilter();
            renderDemos();
          });
          btn.setAttribute('data-filter-type', 'tag');
          btn.setAttribute('data-filter-value', tag);
          tagFiltersRoot.appendChild(btn);
        });

        showAllBtn.addEventListener('click', function () {
          resetAllFilters();
          renderDemos();
        });

        updateFilterButtonStates();
      }

      function bindSearch() {
        if (!searchInput) return;

        searchInput.addEventListener('input', function () {
          state.query = searchInput.value.trim();
          updateURLFromFilter();
          renderDemos();
        });
      }

      showLoadingState();

      fetch('./demos.json', { credentials: 'same-origin' })
        .then(function (response) {
          if (!response.ok) {
            throw new Error(response.status + ' ' + response.statusText);
          }
          return response.json();
        })
        .then(function (demos) {
          state.demos = demos;
          applyFilterFromURL();
          renderFilters();
          bindSearch();
          renderDemos();
        })
        .catch(function (error) {
          statusBox.style.display = 'block';
          statusBox.innerHTML = '<p style="margin: 0;">Failed to load demos.</p>';
          console.warn('[demos] Failed to load demos.json', error);
        });
    })();
  </script>

  <script src="/assets/js/nav-active.js"></script>
</body>

</html>


